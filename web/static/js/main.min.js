!function(a){a(function(){a(".button-collapse").sideNav(),a.validator.addMethod("notempty",function(a,e){return this.optional(e)||/\S/.test(a)},"Пожалуйста, укажите не пустое значение");var e={validate:{validClass:"valid",errorClass:"invalid"}},r={stateAjax:function(e){var r=a(e);r.find("[data-progress]").css("visibility","visible"),r.find(":submit").prop("disabled",!0),r.find(':input:not([readonly="readonly"])').attr("data-ajax-submit","progress").prop("readonly",!0)},stateNormal:function(e){var r=a(e);r.find(":submit").prop("disabled",!1),r.find("[data-progress]").css("visibility","hidden"),r.find(':input[data-ajax-submit="progress"]').attr("data-ajax-submit","").prop("readonly",!1)},populate:function(e,r){var t=a(e);a.each(r,function(a,e){t.find('[name="'+a+'"]').val(e)})},showErrors:function(e,r){var t=a(e).validate(),o={};a.each(r,function(e,r){a.isArray(r)&&(o[e]=r.join("<br>"))}),t.showErrors(o)}};a(document).ajaxError(function(a,e,r,t){0===e.status?console.log("status === 0",a,e,r,t):404==e.status?console.log(404,a,e,r,t):503==e.status?console.log(503,a,e,r,t):"parsererror"===t?console.log("parsererror",a,e,r,t):"timeout"===t?console.log("timeout",a,e,r,t):"abort"===t?console.log("abort",a,e,r,t):console.log("uncaught exception",a,e,r,t)});var t={},o=a("#nav-user-info");o.length&&(t={avatar:o.data("avatar"),username:o.data("username")});var n=a("#nav-balance-handler"),i=a("#order-form");if(i.length){var s=a("#created-orders"),d=Handlebars.compile(a("#created-orders-new").html());i.validate(a.extend({},e.validate,{rules:{description:{notempty:{}}},submitHandler:function(e){var o=a(e);o.ajaxSubmit({beforeSubmit:function(){r.stateAjax(e)}}).data("jqxhr").done(function(o,n,i){if(o.createdOrder&&!a.isEmptyObject(o.createdOrder)){Materialize.toast("Заказ на сумму "+o.createdOrder.price_dollar+" успешно добавлен",6e3);var l=d({customer:t,order:o.createdOrder});s.prepend(l)}o.order&&r.populate(e,o.order),o.errors&&r.showErrors(e,o.errors),o.createErrors&&!a.isEmptyObject(o.createErrors)&&a.each(o.createErrors,function(a,e){Materialize.toast("Ошибка: "+a,6e3)})}).always(function(a,t){r.stateNormal(e)})}}))}a('form[data-form="execute-order"]').on("submit",function(){var e=this,t=a(e).find('[name="id"]').val(),o=a("#order-item-"+t);return a(this).ajaxSubmit({beforeSubmit:function(){r.stateAjax(e)}}).data("jqxhr").done(function(e,r,t){e.success&&("undefined"!=typeof e.balance&&e.balance!==!1?(Materialize.toast("Успешно! Ваш баланс: "+e.balance,6e3),n.html(e.balance)):Materialize.toast("Не удалось получить баланс",6e3),o.length&&(o.find(":submit").remove(),o.fadeOut(200,function(){a(this).remove()}))),e.error&&Materialize.toast(e.error,6e3)}).always(function(a,t){r.stateNormal(e)}),!1})})}(jQuery);